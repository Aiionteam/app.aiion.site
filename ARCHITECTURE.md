# AIION ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”](#ì „ì²´-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ê° ì»´í¬ë„ŒíŠ¸ ì—­í• ](#ê°-ì»´í¬ë„ŒíŠ¸-ì—­í• )
3. [ì„œë¹„ìŠ¤ ê°„ í†µì‹  íë¦„](#ì„œë¹„ìŠ¤-ê°„-í†µì‹ -íë¦„)
4. [Gatewayì™€ Eureka í†µì‹  ë©”ì»¤ë‹ˆì¦˜](#gatewayì™€-eureka-í†µì‹ -ë©”ì»¤ë‹ˆì¦˜)
5. [ë™ì‹œì„± ë° ì¶©ëŒ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜](#ë™ì‹œì„±-ë°-ì¶©ëŒ-ë°©ì§€-ë©”ì»¤ë‹ˆì¦˜)
6. [ì‹¤ì œ ìš”ì²­ ì‹œë‚˜ë¦¬ì˜¤](#ì‹¤ì œ-ìš”ì²­-ì‹œë‚˜ë¦¬ì˜¤)
7. [í¬íŠ¸ ë§µ](#í¬íŠ¸-ë§µ)

---

## ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Client Layer                             â”‚
â”‚                                                             â”‚
â”‚              Frontend (Next.js + React)                     â”‚
â”‚                    Port: 3000                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ HTTP ìš”ì²­
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Edge Layer                               â”‚
â”‚                                                             â”‚
â”‚            Spring Cloud Gateway (WebFlux)                   â”‚
â”‚                    Port: 8080                               â”‚
â”‚              - API ë¼ìš°íŒ…                                    â”‚
â”‚              - Rate Limiting (ì¤€ë¹„ë¨)                        â”‚
â”‚              - CORS ì²˜ë¦¬                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
           â”‚ Eurekaì— ì„œë¹„ìŠ¤ ìœ„ì¹˜ ì¡°íšŒ         â”‚
           â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     Infrastructure Layer (ë…ë¦½)         â”‚  â”‚
â”‚                                         â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚   Eureka     â”‚  â”‚  Config Server  â”‚ â”‚  â”‚
â”‚  â”‚   :8761      â”‚  â”‚     :8888       â”‚ â”‚  â”‚
â”‚  â”‚              â”‚  â”‚                 â”‚ â”‚  â”‚
â”‚  â”‚ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬â”‚  â”‚   ì¤‘ì•™ ì„¤ì • ê´€ë¦¬  â”‚ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚         â–²                               â”‚  â”‚
â”‚         â”‚ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ìì‹ ì„ ë“±ë¡        â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
          â”‚                                  â”‚
          â”‚                                  â”‚ ì‹¤ì œ ìš”ì²­ ì „ë‹¬
          â”‚                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Service Layer                              â”‚
â”‚            (ëª¨ë“  ì„œë¹„ìŠ¤ê°€ Eureka í´ë¼ì´ì–¸íŠ¸)                   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  User    â”‚  â”‚  Diary   â”‚  â”‚ Calendar â”‚  â”‚   Soccer   â”‚  â”‚
â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚  Service   â”‚  â”‚
â”‚  â”‚  :8082   â”‚  â”‚  :8083   â”‚  â”‚  :8084   â”‚  â”‚   :8085    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Culture  â”‚  â”‚Healthcareâ”‚  â”‚  Common   â”‚                 â”‚
â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚  Service  â”‚                 â”‚
â”‚  â”‚  :8086   â”‚  â”‚  :8087   â”‚  â”‚   :8081   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚      AI Middleware (ì¤€ë¹„)          â”‚                     â”‚
â”‚  â”‚          :8090                     â”‚                     â”‚
â”‚  â”‚  - NLP, ì¶”ì²œ, ê°ì • ë¶„ì„            â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ ë°ì´í„° ì ‘ê·¼
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Data Layer                               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  PostgreSQL    â”‚          â”‚    Redis     â”‚              â”‚
â”‚  â”‚    :5432       â”‚          â”‚    :6379     â”‚              â”‚
â”‚  â”‚                â”‚          â”‚              â”‚              â”‚
â”‚  â”‚ - OLTP         â”‚          â”‚ - Cache      â”‚              â”‚
â”‚  â”‚ - íŠ¸ëœì­ì…˜ DB   â”‚          â”‚ - Session    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ - Pub/Sub    â”‚              â”‚
â”‚                              â”‚ - Queue      â”‚              â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê° ì»´í¬ë„ŒíŠ¸ ì—­í• 

### 1. Eureka Server (Service Registry)
**ë…ë¦½ì ì¸ ì¸í”„ë¼ ì„œë¹„ìŠ¤**

- **ì—­í• **: ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì˜ "ì „í™”ë²ˆí˜¸ë¶€"
- **ê¸°ëŠ¥**:
  - ì„œë¹„ìŠ¤ë“¤ì´ ì‹œì‘í•  ë•Œ ìì‹ ì˜ ìœ„ì¹˜(IP, í¬íŠ¸)ë¥¼ ë“±ë¡
  - ë‹¤ë¥¸ ì„œë¹„ìŠ¤ê°€ íŠ¹ì • ì„œë¹„ìŠ¤ë¥¼ ì°¾ì„ ë•Œ ìœ„ì¹˜ ì •ë³´ ì œê³µ
  - Health Checkë¥¼ í†µí•´ ì„œë¹„ìŠ¤ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- **í¬íŠ¸**: 8761
- **ê´€ê³„**: Gatewayì™€ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ Eurekaì˜ "í´ë¼ì´ì–¸íŠ¸"

```yaml
# ë“±ë¡ëœ ì„œë¹„ìŠ¤ ì˜ˆì‹œ
Eureka Registry:
  - gateway-server    â†’ localhost:8080
  - user-service      â†’ localhost:8082
  - diary-service     â†’ localhost:8083
  - calendar-service  â†’ localhost:8084
  - ai-middleware     â†’ localhost:8090 (ì˜ˆì •)
```

### 2. Config Server (ì¤‘ì•™ ì„¤ì • ê´€ë¦¬)
**ë…ë¦½ì ì¸ ì¸í”„ë¼ ì„œë¹„ìŠ¤**

- **ì—­í• **: ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ì„¤ì • íŒŒì¼ì„ ì¤‘ì•™ì—ì„œ ê´€ë¦¬
- **ê¸°ëŠ¥**:
  - application.yml ë“± ì„¤ì • íŒŒì¼ í†µí•© ê´€ë¦¬
  - í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬ (dev, prod ë“±)
  - ëŸ°íƒ€ì„ì— ì„¤ì • ë³€ê²½ ê°€ëŠ¥
- **í¬íŠ¸**: 8888
- **ê´€ê³„**: ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì‹œì‘ ì‹œ Config Serverì—ì„œ ì„¤ì •ì„ ê°€ì ¸ê°

### 3. Spring Cloud Gateway
**Edge Layer (API Gateway)**

- **ì—­í• **: ëª¨ë“  ì™¸ë¶€ ìš”ì²­ì˜ "ê´€ë¬¸"ì´ì "íŠ¸ë˜í”½ ê²½ì°°"
- **ê¸°ëŠ¥**:
  - API ë¼ìš°íŒ…: ìš”ì²­ì„ ì ì ˆí•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ì „ë‹¬
  - Load Balancing: ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒ
  - CORS ì²˜ë¦¬
  - Rate Limiting (Redis ì—°ë™, ì¤€ë¹„ë¨)
  - ì¸ì¦/ì¸ê°€ (ì˜ˆì •)
- **í¬íŠ¸**: 8080
- **ê´€ê³„**: 
  - Eurekaì˜ **í´ë¼ì´ì–¸íŠ¸** (ì„œë¹„ìŠ¤ ìœ„ì¹˜ë¥¼ ì¡°íšŒí•¨)
  - ëª¨ë“  ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì˜ **í”„ë¡ì‹œ**

```yaml
# Gateway ë¼ìš°íŒ… ì„¤ì • ì˜ˆì‹œ
/user/**     â†’ user-service:8082
/diary/**    â†’ diary-service:8083
/calendar/** â†’ calendar-service:8084
/ai/**       â†’ ai-middleware:8090 (ì˜ˆì •)
```

### 4. Microservices (Domain Services)
**ë…ë¦½ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„œë¹„ìŠ¤ë“¤**

- **ê³µí†µ íŠ¹ì§•**:
  - ê°ê° ë…ë¦½ì ì¸ DB ìŠ¤í‚¤ë§ˆ ì‚¬ìš©
  - Eurekaì— ìì‹ ì„ ë“±ë¡ (Eureka í´ë¼ì´ì–¸íŠ¸)
  - Config Serverì—ì„œ ì„¤ì • ë¡œë“œ
  - Redis ìºì‹± ì‚¬ìš© ê°€ëŠ¥
- **ì„œë¹„ìŠ¤ ëª©ë¡**:
  - common-service (8081): ê³µí†µ ê¸°ëŠ¥
  - user-service (8082): ì‚¬ìš©ì ê´€ë¦¬
  - diary-service (8083): ì¼ê¸° ê´€ë¦¬
  - calendar-service (8084): ì¼ì • ê´€ë¦¬
  - soccer-service (8085): ì¶•êµ¬ ì •ë³´
  - culture-service (8086): ë¬¸í™” ì •ë³´
  - healthcare-service (8087): ê±´ê°• ê´€ë¦¬

### 5. AI Middleware (ì¤€ë¹„ ì¤‘)
**AI/ML ì „ìš© ì„œë¹„ìŠ¤**

- **ì—­í• **: AI ëª¨ë¸ ì¶”ë¡  ì„œë¹„ìŠ¤
- **ê¸°ëŠ¥**:
  - NLP (ìì—°ì–´ ì²˜ë¦¬)
  - ê°ì • ë¶„ì„
  - ì¶”ì²œ ì‹œìŠ¤í…œ
  - Redis íë¥¼ í†µí•œ ë¹„ë™ê¸° ì²˜ë¦¬
- **í¬íŠ¸**: 8090
- **íŠ¹ì§•**: GPU ì„œë²„ì— ë…ë¦½ì ìœ¼ë¡œ ë°°í¬ ê°€ëŠ¥

### 6. Data Layer

#### PostgreSQL
- **ì—­í• **: ë©”ì¸ íŠ¸ëœì­ì…˜ DB
- **í¬íŠ¸**: 5432
- **ìš©ë„**: ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ì˜ì† ë°ì´í„° ì €ì¥

#### Redis
- **ì—­í• **: ìºì‹±, ì„¸ì…˜, Pub/Sub, í
- **í¬íŠ¸**: 6379
- **ìš©ë„**:
  - ìºì‹œ: ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°
  - ì„¸ì…˜: ì‚¬ìš©ì ì„¸ì…˜ ê´€ë¦¬
  - Pub/Sub: ì„œë¹„ìŠ¤ ê°„ ì´ë²¤íŠ¸ ì „ë‹¬
  - Queue: ë¹„ë™ê¸° ì‘ì—… ì²˜ë¦¬

---

## ì„œë¹„ìŠ¤ ê°„ í†µì‹  íë¦„

### Gatewayê°€ ì„œë¹„ìŠ¤ë¥¼ ì°¾ëŠ” ê³¼ì •

```
1. Gateway ì‹œì‘
   â†“
2. Eurekaì— ìì‹ ì„ ë“±ë¡
   - ì´ë¦„: gateway-server
   - ì£¼ì†Œ: localhost:8080
   â†“
3. ìš”ì²­ ë°›ìŒ: GET /user/123
   â†“
4. ë¼ìš°íŒ… ê·œì¹™ í™•ì¸
   - /user/** â†’ user-serviceë¡œ ì „ë‹¬
   â†“
5. Eurekaì— ì§ˆì˜
   - "user-serviceì˜ ì£¼ì†Œë¥¼ ì•Œë ¤ì¤˜"
   â†“
6. Eureka ì‘ë‹µ
   - "user-serviceëŠ” localhost:8082ì— ìˆì–´"
   â†“
7. ì‹¤ì œ í˜¸ì¶œ
   - http://localhost:8082/user/123
   â†“
8. User Service ì‘ë‹µ
   â†“
9. Gatewayê°€ Frontendì— ì‘ë‹µ ì „ë‹¬
```

### ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì‹œì‘ ê³¼ì •

```
1. ì„œë¹„ìŠ¤ ì‹œì‘ (ì˜ˆ: user-service)
   â†“
2. Config Serverì—ì„œ ì„¤ì • ë¡œë“œ
   - http://config-server:8888/user-service
   â†“
3. ì„¤ì • ì ìš© (DB ì—°ê²°, Redis ì„¤ì • ë“±)
   â†“
4. Eurekaì— ìì‹ ì„ ë“±ë¡
   - ì´ë¦„: user-service
   - ì£¼ì†Œ: localhost:8082
   - Health Check URL: /actuator/health
   â†“
5. ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ
   â†“
6. 30ì´ˆë§ˆë‹¤ Eurekaì— Heartbeat ì „ì†¡
   - "ë‚˜ ì•„ì§ ì‚´ì•„ìˆì–´!"
```

---

## Gatewayì™€ Eureka í†µì‹  ë©”ì»¤ë‹ˆì¦˜

### ğŸ¯ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤: ìºì‹± + ì§ì ‘ í˜¸ì¶œ

**GatewayëŠ” Eurekaë¥¼ "í†µí•˜ì§€ ì•Šê³ " ì„œë¹„ìŠ¤ì— ì§ì ‘ ìš”ì²­í•©ë‹ˆë‹¤!**

```
âœ… ì˜¬ë°”ë¥¸ ë°©ì‹ (ìš°ë¦¬ì˜ êµ¬ì¡°):
Frontend â†’ Gateway â†’ Service (ì§ì ‘!)
             â†‘
             â”‚ (ìµœì´ˆ 1íšŒ + 30ì´ˆë§ˆë‹¤ ê°±ì‹ )
           Eureka

âŒ ì˜ëª»ëœ ë°©ì‹ (ì•ˆí‹°íŒ¨í„´):
Frontend â†’ Gateway â†’ Eureka â†’ Service
```

### ì™œ ì´ê²Œ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ì¸ê°€?

#### 1. ì„±ëŠ¥ ìµœì í™” âš¡
```
ë§¤ ìš”ì²­ë§ˆë‹¤ Eureka ì¡°íšŒ (X):
  ìš”ì²­ â†’ Eureka ì¡°íšŒ(10ms) â†’ ì„œë¹„ìŠ¤ í˜¸ì¶œ(100ms) = ì´ 110ms
  1000 TPS = Eurekaì— 10ì´ˆ/ì´ˆ ë¶€í•˜

ìºì‹± + ì§ì ‘ í˜¸ì¶œ (O):
  ìš”ì²­ â†’ ë©”ëª¨ë¦¬ ì¡°íšŒ(0.1ms) â†’ ì„œë¹„ìŠ¤ í˜¸ì¶œ(100ms) = ì´ 100ms
  1000 TPS = Eurekaì— 0.033 TPS ë¶€í•˜ (30ì´ˆë§ˆë‹¤ 1ë²ˆ)
  
â†’ Eureka ë¶€í•˜ 30,000ë°° ê°ì†Œ! ğŸš€
```

#### 2. ì¥ì•  ê²©ë¦¬ ğŸ›¡ï¸
```
Eureka ë‹¤ìš´ ì‹œ:

ë§¤ ìš”ì²­ë§ˆë‹¤ ì¡°íšŒí•˜ëŠ” ë°©ì‹:
  - Eureka ì£½ìŒ â†’ ëª¨ë“  ìš”ì²­ ì‹¤íŒ¨ ğŸ’¥
  
ìºì‹± ë°©ì‹:
  - Eureka ì£½ìŒ â†’ ìºì‹œëœ ì£¼ì†Œë¡œ ê³„ì† ì‘ë™ âœ…
  - ê¸°ì¡´ ì„œë¹„ìŠ¤ëŠ” ì •ìƒ ìš´ì˜
  - ìƒˆ ì„œë¹„ìŠ¤ ë“±ë¡ë§Œ ì•ˆ ë¨
```

#### 3. í™•ì¥ì„± ğŸ“ˆ
```
ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì¦ê°€ ì‹œ:

ìºì‹± ë°©ì‹:
  1. user-service ì¸ìŠ¤í„´ìŠ¤ 2ê°œ â†’ 5ê°œ ì¦ê°€
  2. ìƒˆ ì¸ìŠ¤í„´ìŠ¤ë“¤ì´ Eurekaì— ë“±ë¡
  3. 30ì´ˆ í›„ Gatewayê°€ ìë™ ì¸ì‹
  4. 5ê°œ ì¸ìŠ¤í„´ìŠ¤ì— ìë™ ë¶€í•˜ ë¶„ì‚°
  
â†’ ë™ì  ìŠ¤ì¼€ì¼ë§ ì™„ë²½ ì§€ì›!
```

### Gatewayì˜ ì‹¤ì œ ë™ì‘ íë¦„

#### ìµœì´ˆ 1íšŒ (Gateway ì‹œì‘ ì‹œ)
```
[Gateway ì‹œì‘]
  â†“
[Eurekaì— ì „ì²´ ì„œë¹„ìŠ¤ ëª©ë¡ ìš”ì²­]
  GET http://eureka:8761/eureka/apps
  â†“
[ì‘ë‹µ ë°›ìŒ]
  {
    "user-service": ["192.168.1.10:8082", "192.168.1.11:8082"],
    "diary-service": ["192.168.1.20:8083"],
    "calendar-service": ["192.168.1.30:8084"]
  }
  â†“
[ë©”ëª¨ë¦¬ì— ìºì‹±]
  serviceCache = {
    "user-service": ["192.168.1.10:8082", "192.168.1.11:8082"],
    "diary-service": ["192.168.1.20:8083"],
    ...
  }
```

#### ì´í›„ ëª¨ë“  ìš”ì²­ (ìºì‹œ ì‚¬ìš©)
```
[Frontend ìš”ì²­]
  GET http://gateway:8080/user/123
  â†“
[Gateway - ë¼ìš°íŒ… ê·œì¹™ í™•ì¸]
  /user/** â†’ user-service
  â†“
[Gateway - ë¡œì»¬ ìºì‹œ ì¡°íšŒ] âš¡ (0.1ms)
  serviceCache.get("user-service")
  â†’ ["192.168.1.10:8082", "192.168.1.11:8082"]
  â†“
[Gateway - Client-Side Load Balancing]
  Round Robin ì•Œê³ ë¦¬ì¦˜
  â†’ 192.168.1.10:8082 ì„ íƒ
  â†“
[Gateway - ì§ì ‘ HTTP í˜¸ì¶œ] ğŸš€
  http://192.168.1.10:8082/user/123
  (Eurekaë¥¼ ê±°ì¹˜ì§€ ì•ŠìŒ!)
  â†“
[User Service ì‘ë‹µ]
  â†“
[Gateway â†’ Frontend ì‘ë‹µ ì „ë‹¬]
```

#### ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹  (30ì´ˆë§ˆë‹¤)
```
[íƒ€ì´ë¨¸ íŠ¸ë¦¬ê±°]
  â†“
[Eurekaì— ë³€ê²½ì‚¬í•­ë§Œ ì¡°íšŒ]
  GET http://eureka:8761/eureka/apps/delta
  â†“
[ë³€ê²½ì‚¬í•­ ì ìš©]
  - ìƒˆ ì„œë¹„ìŠ¤ ì¶”ê°€
  - ì£½ì€ ì„œë¹„ìŠ¤ ì œê±°
  - ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ ë³€ê²½
  â†“
[ë¡œì»¬ ìºì‹œ ì—…ë°ì´íŠ¸]
```

### Spring Cloudì˜ Client-Side Load Balancing

```java
// Gateway ë‚´ë¶€ ë™ì‘ (Spring Cloud LoadBalancer)
@Configuration
public class GatewayConfig {
    
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {
        return builder.routes()
            .route("user-service", r -> r
                .path("/user/**")
                .uri("lb://user-service"))  // lb:// = LoadBalanced
            .build();
    }
}

// ì‹¤ì œ ë™ì‘:
// 1. "lb://user-service" í™•ì¸
// 2. Eureka ìºì‹œì—ì„œ user-service ì¸ìŠ¤í„´ìŠ¤ ëª©ë¡ ì¡°íšŒ
// 3. LoadBalancerê°€ í•˜ë‚˜ ì„ íƒ (Round Robin, Random, etc.)
// 4. ì„ íƒëœ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì§ì ‘ HTTP ìš”ì²­
```

### Eureka ìºì‹± ì„¤ì •

```yaml
# Gatewayì˜ application.yml
eureka:
  client:
    registry-fetch-interval-seconds: 30  # 30ì´ˆë§ˆë‹¤ ê°±ì‹ 
    cache-refresh-enabled: true
    initial-instance-info-replication-interval-seconds: 40
    
  instance:
    lease-renewal-interval-in-seconds: 30  # Heartbeat ì£¼ê¸°
    lease-expiration-duration-in-seconds: 90  # 90ì´ˆ ì‘ë‹µ ì—†ìœ¼ë©´ ì œê±°
```

### ì„±ëŠ¥ ë¹„êµ

| ë°©ì‹ | ìš”ì²­ë‹¹ Eureka ì¡°íšŒ | Eureka ë¶€í•˜ (1000 TPS) | ì‘ë‹µ ì‹œê°„ | ì¥ì•  í—ˆìš©ì„± |
|------|-------------------|----------------------|----------|------------|
| ë§¤ë²ˆ ì¡°íšŒ | âœ… ë§¤ ìš”ì²­ë§ˆë‹¤ | 1000 TPS | 110ms | âŒ ë‚®ìŒ |
| ìºì‹± (ë² ìŠ¤íŠ¸) | âŒ 30ì´ˆë§ˆë‹¤ 1ë²ˆ | 0.033 TPS | 100ms | âœ… ë†’ìŒ |

### ì¶”ê°€ ì´ì 

#### 1. Circuit Breaker ì ìš© ê°€ëŠ¥
```java
.route("user-service", r -> r.path("/user/**")
    .filters(f -> f
        .circuitBreaker(c -> c
            .setName("userServiceCB")
            .setFallbackUri("/fallback/user"))
    )
    .uri("lb://user-service"))
```

#### 2. Canary ë°°í¬ ì§€ì›
```yaml
routes:
  - id: user-v1
    uri: lb://user-service-v1
    predicates:
      - Weight=user-group, 90  # 90% íŠ¸ë˜í”½
      
  - id: user-v2
    uri: lb://user-service-v2
    predicates:
      - Weight=user-group, 10  # 10% íŠ¸ë˜í”½ (ì‹ ê·œ ë²„ì „ í…ŒìŠ¤íŠ¸)
```

#### 3. Retry ë° Timeout ì„¤ì •
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/user/**
          filters:
            - name: Retry
              args:
                retries: 3
                statuses: BAD_GATEWAY
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
```

---

## ë™ì‹œì„± ë° ì¶©ëŒ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜

### ğŸ¯ ê²°ë¡ : ì¶©ëŒ ì—†ì´ ë™ì‹œ ì²˜ë¦¬ ê°€ëŠ¥!

ìš°ë¦¬ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ëŠ” **ìˆ˜ì²œ ê°œì˜ ë™ì‹œ ìš”ì²­ì„ ì¶©ëŒ ì—†ì´ ì²˜ë¦¬**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì™œ ì¶©ëŒì´ ë‚˜ì§€ ì•ŠëŠ”ê°€?

#### 1. Stateless ì•„í‚¤í…ì²˜ ğŸ”„
```
ê° ìš”ì²­ì€ ì™„ì „íˆ ë…ë¦½ì :

ìš”ì²­ A: Frontend â†’ Gateway â†’ User Service (8082)
ìš”ì²­ B: Frontend â†’ Gateway â†’ Diary Service (8083)
ìš”ì²­ C: Frontend â†’ Gateway â†’ User Service (8082)

â†’ ê° ìš”ì²­ì´ ë…ë¦½ëœ ìŠ¤ë ˆë“œì—ì„œ ì²˜ë¦¬
â†’ ê³µìœ  ìƒíƒœ ì—†ìŒ (Stateless)
â†’ ë™ì‹œ ì²˜ë¦¬ ê°€ëŠ¥ âœ…
```

#### 2. ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤ í¬íŠ¸ ğŸšª
```yaml
ê° ì„œë¹„ìŠ¤ëŠ” ìì‹ ë§Œì˜ í¬íŠ¸ ì‚¬ìš©:
- user-service: 8082
- diary-service: 8083
- calendar-service: 8084
- soccer-service: 8085
- culture-service: 8086
- healthcare-service: 8087

â†’ ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ë¨
â†’ ì ˆëŒ€ ì¶©ëŒ ë¶ˆê°€ëŠ¥ âœ…
```

#### 3. Gatewayì˜ Non-blocking I/O (WebFlux) âš¡
```
ì „í†µì  ë°©ì‹ (Blocking):
ìš”ì²­ 1 â†’ Thread 1 (ëŒ€ê¸° ì¤‘...)
ìš”ì²­ 2 â†’ Thread 2 (ëŒ€ê¸° ì¤‘...)
...
ìš”ì²­ 200 â†’ Thread 200 (ëŒ€ê¸° ì¤‘...)
ìš”ì²­ 201 â†’ âŒ Thread ë¶€ì¡±! ëŒ€ê¸°...

Gateway (Non-blocking WebFlux):
ìš”ì²­ 1-10000 â†’ Event Loop (ìŠ¤ë ˆë“œ 4ê°œ)
â†’ ëª¨ë‘ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬
â†’ ë™ì‹œ ìˆ˜ë§Œ ê°œ ì²˜ë¦¬ ê°€ëŠ¥ âœ…
```

#### 4. ë¼ìš°íŒ… ê²½ë¡œ ë¶„ë¦¬ ğŸ›£ï¸
```yaml
# Gateway ë¼ìš°íŒ… ì„¤ì •
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/user/**      â† /userë¡œ ì‹œì‘
            
        - id: diary-service
          uri: lb://diary-service
          predicates:
            - Path=/diary/**     â† /diaryë¡œ ì‹œì‘

â†’ ê²½ë¡œê°€ ê²¹ì¹˜ì§€ ì•ŠìŒ
â†’ ë¼ìš°íŒ… ì¶©ëŒ ë¶ˆê°€ëŠ¥ âœ…
```

### ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ì‹œë®¬ë ˆì´ì…˜

```
ì‹œê°„ T=0ms: 1000ê°œ ë™ì‹œ ìš”ì²­ ë„ì°©

[1000 Requests]
    â†“ (ëª¨ë‘ ë™ì‹œì—)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gateway      â”‚ â† Non-blocking WebFlux
â”‚  (4 threads)   â”‚   Event Loopë¡œ ëª¨ë‘ ìˆ˜ìš©
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ ë¼ìš°íŒ… (ê²½ë¡œë³„ ë¶„ì‚°)
     â”‚
â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚    â”‚       â”‚      â”‚      â”‚      â”‚
â–¼    â–¼       â–¼      â–¼      â–¼      â–¼
User  Diary  Cal   Soccer Culture Health
8082  8083   8084  8085   8086    8087

ê° ì„œë¹„ìŠ¤:
- ë…ë¦½ëœ í”„ë¡œì„¸ìŠ¤
- ë…ë¦½ëœ ë©”ëª¨ë¦¬ ê³µê°„
- ë…ë¦½ëœ ìŠ¤ë ˆë“œ í’€
- ë…ë¦½ëœ DB ì»¤ë„¥ì…˜ í’€

â†’ ì„œë¡œ ê°„ì„­ ë¶ˆê°€ëŠ¥! âœ…
```

### ì¶©ëŒ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ ìƒì„¸

#### 1. ì»¤ë„¥ì…˜ í’€ ê´€ë¦¬
```yaml
# ê° ì„œë¹„ìŠ¤ì˜ PostgreSQL ì„¤ì •
spring:
  datasource:
    hikari:
      maximum-pool-size: 10      # ë™ì‹œ 10ê°œ ì—°ê²°
      minimum-idle: 5
      connection-timeout: 30000  # 30ì´ˆ ëŒ€ê¸°
      max-lifetime: 1800000      # 30ë¶„

â†’ ë™ì‹œ ìš”ì²­ 100ê°œì—¬ë„:
  - 10ê°œì”© ì²˜ë¦¬
  - ë‚˜ë¨¸ì§€ëŠ” íì—ì„œ ëŒ€ê¸°
  - ì•ˆì „í•˜ê²Œ ìˆœì°¨ ì²˜ë¦¬ âœ…
```

#### 2. Redis ì»¤ë„¥ì…˜ í’€
```yaml
spring:
  redis:
    lettuce:
      pool:
        max-active: 8    # ë™ì‹œ 8ê°œ ì—°ê²°
        max-idle: 8
        min-idle: 0

â†’ Redis ì ‘ê·¼ë„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ âœ…
```

#### 3. ìŠ¤ë ˆë“œ í’€ ê´€ë¦¬
```yaml
# Spring MVC ê¸°ë³¸ ì„¤ì • (Tomcat)
server:
  tomcat:
    threads:
      max: 200          # ìµœëŒ€ 200ê°œ ìŠ¤ë ˆë“œ
      min-spare: 10     # ìµœì†Œ 10ê°œ ëŒ€ê¸°

â†’ ë™ì‹œ 200ê°œ ìš”ì²­ê¹Œì§€ ì²˜ë¦¬
â†’ ì´ˆê³¼ ì‹œ íì—ì„œ ëŒ€ê¸° âœ…
```

### ë™ì‹œì„± ì²˜ë¦¬ ëŠ¥ë ¥ ê³„ì‚°

```
í˜„ì¬ êµ¬ì¡°ì˜ ì´ë¡ ì  ì²˜ë¦¬ ëŠ¥ë ¥:

Gateway (WebFlux):
â””â”€ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤: ~10,000 TPS
   (Non-blockingì´ë¯€ë¡œ CPU ë°”ìš´ë“œ)

User Service (Spring MVC):
â””â”€ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤: ~500 TPS
   (ìŠ¤ë ˆë“œ í’€ 200ê°œ ê¸°ì¤€, ì‘ë‹µì‹œê°„ 400ms ê°€ì •)

ì‹œìŠ¤í…œ ì „ì²´:
â”œâ”€ User Service (3 ì¸ìŠ¤í„´ìŠ¤): 1,500 TPS
â”œâ”€ Diary Service (2 ì¸ìŠ¤í„´ìŠ¤): 1,000 TPS
â”œâ”€ Calendar Service (2 ì¸ìŠ¤í„´ìŠ¤): 1,000 TPS
â”œâ”€ Soccer Service (2 ì¸ìŠ¤í„´ìŠ¤): 1,000 TPS
â””â”€ í•©ê³„: ~4,500 TPS

â†’ ë™ì‹œ ìš”ì²­ 4,500ê°œê¹Œì§€ ì¶©ëŒ ì—†ì´ ì²˜ë¦¬ ê°€ëŠ¥! ğŸš€
```

### ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì˜ˆìƒ ê²°ê³¼

```bash
# Apache Benchë¡œ 1000ê°œ ë™ì‹œ ìš”ì²­
ab -n 1000 -c 100 http://localhost:8080/user/123

# ì˜ˆìƒ ê²°ê³¼:
Concurrency Level:      100
Time taken for tests:   0.667 seconds
Complete requests:      1000
Failed requests:        0           â† ì¶©ëŒ ì—†ìŒ!
Requests per second:    1500.00 [#/sec]
Time per request:       66.67 [ms]
```

### ì¶©ëŒì´ ë‚  ìˆ˜ ìˆëŠ” ê²½ìš° (ìš°ë¦¬ëŠ” ì•ˆì „í•¨)

#### âŒ ì•ˆí‹°íŒ¨í„´ 1: ê³µìœ  ìƒíƒœ
```java
// ë‚˜ìœ ì˜ˆ (ìš°ë¦¬ëŠ” ì•ˆ í•¨!)
public class UserService {
    private static int requestCount = 0;  // ê³µìœ  ë³€ìˆ˜!
    
    public User getUser(Long id) {
        requestCount++;  // Race Condition ë°œìƒ ğŸ’¥
        return userRepository.findById(id);
    }
}
```

#### âœ… ìš°ë¦¬ ë°©ì‹: Stateless
```java
// ì¢‹ì€ ì˜ˆ (ìš°ë¦¬ê°€ ì‚¬ìš©)
@Service
public class UserService {
    @Autowired
    private UserRepository userRepository;  // ìŠ¤ë ˆë“œ ì•ˆì „
    
    public User getUser(Long id) {
        return userRepository.findById(id);  // ì¶©ëŒ ì—†ìŒ! âœ…
    }
}
```

#### âŒ ì•ˆí‹°íŒ¨í„´ 2: ê°™ì€ í¬íŠ¸ ì‚¬ìš©
```yaml
# ë‚˜ìœ ì˜ˆ (ìš°ë¦¬ëŠ” ì•ˆ í•¨!)
user-service:
  ports: ["8080:8080"]
diary-service:
  ports: ["8080:8080"]  # ğŸ’¥ í¬íŠ¸ ì¶©ëŒ!
```

#### âœ… ìš°ë¦¬ ë°©ì‹: í¬íŠ¸ ë¶„ë¦¬
```yaml
# ì¢‹ì€ ì˜ˆ (docker-compose.yaml)
user-service:
  ports: ["8082:8082"]
diary-service:
  ports: ["8083:8083"]  # âœ… ê°ì ë‹¤ë¥¸ í¬íŠ¸
```

### ë™ì‹œì„± ë³´ì¥ ì›ì¹™

```
1. Stateless ì„¤ê³„
   â†’ ì„œë¹„ìŠ¤ê°€ ìƒíƒœë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ
   â†’ ëª¨ë“  ìƒíƒœëŠ” DB/Redisì—ë§Œ ì €ì¥

2. Immutable Data
   â†’ ìš”ì²­ ë°ì´í„°ëŠ” ë³€ê²½ ë¶ˆê°€ëŠ¥
   â†’ ìƒˆë¡œìš´ ê°ì²´ ìƒì„±ìœ¼ë¡œ ì²˜ë¦¬

3. Thread-Safe Components
   â†’ Spring Beanì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ì´ì§€ë§Œ ìŠ¤ë ˆë“œ ì•ˆì „
   â†’ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ì‚¬ìš© ìµœì†Œí™”

4. Connection Pooling
   â†’ DB, Redis ì»¤ë„¥ì…˜ì„ í’€ë¡œ ê´€ë¦¬
   â†’ ë™ì‹œ ì ‘ê·¼ ì œì–´

5. ë…ë¦½ì ì¸ í”„ë¡œì„¸ìŠ¤
   â†’ ê° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” ë…ë¦½ ì‹¤í–‰
   â†’ ë©”ëª¨ë¦¬ ê³µê°„ ë¶„ë¦¬
```

### ì‹¤ì œ ë™ì‹œ ì²˜ë¦¬ ì˜ˆì‹œ

```
ë™ì‹œì— 1000ëª…ì´ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ í˜¸ì¶œ:

T=0ms:
â”œâ”€ User A: GET /user/1
â”œâ”€ User B: GET /diary/100
â”œâ”€ User C: GET /calendar/50
â”œâ”€ User D: GET /user/2
â””â”€ ... (996 more)

Gateway:
â”œâ”€ Event Loopë¡œ ëª¨ë‘ ìˆ˜ìš© (Non-blocking)
â”œâ”€ ë¼ìš°íŒ…:
â”‚   â”œâ”€ 300ê°œ â†’ user-service
â”‚   â”œâ”€ 250ê°œ â†’ diary-service
â”‚   â”œâ”€ 200ê°œ â†’ calendar-service
â”‚   â””â”€ 250ê°œ â†’ ê¸°íƒ€ ì„œë¹„ìŠ¤
â””â”€ ëª¨ë‘ ë™ì‹œì— ì „ë‹¬

ê° ì„œë¹„ìŠ¤:
â”œâ”€ ìŠ¤ë ˆë“œ í’€ë¡œ ìˆœì°¨ ì²˜ë¦¬
â”œâ”€ DB ì»¤ë„¥ì…˜ í’€ë¡œ ì•ˆì „í•˜ê²Œ ì ‘ê·¼
â””â”€ ì™„ë£Œ í›„ Gatewayë¡œ ì‘ë‹µ

Gateway:
â””â”€ ê° ì‚¬ìš©ìì—ê²Œ ì‘ë‹µ ì „ë‹¬

ê²°ê³¼:
â””â”€ ì¶©ëŒ 0ê°œ, ì‹¤íŒ¨ 0ê°œ âœ…
```

### ì„±ëŠ¥ ìµœì í™” ì „ëµ

```yaml
# 1. Redis ìºì‹±ìœ¼ë¡œ DB ë¶€í•˜ ê°ì†Œ
@Cacheable(value = "users", key = "#id")
public User findUser(Long id) { ... }

# 2. ë¹„ë™ê¸° ì²˜ë¦¬ (í•„ìš” ì‹œ)
@Async
public CompletableFuture<User> findUserAsync(Long id) { ... }

# 3. Rate Limiting (Gateway)
spring:
  cloud:
    gateway:
      routes:
        - filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10

# 4. Circuit Breaker (ì¥ì•  ê²©ë¦¬)
@CircuitBreaker(name = "userService")
public User findUser(Long id) { ... }
```

---

## ì‹¤ì œ ìš”ì²­ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ

```
[Frontend]
  â†“ GET http://localhost:8080/user/123
  
[Gateway:8080]
  â†“ 1. ë¼ìš°íŒ… ê·œì¹™ í™•ì¸: /user/** â†’ user-service
  â†“ 2. Eureka ì¡°íšŒ: "user-service ì–´ë””?"
  â†“ 3. Eureka ì‘ë‹µ: "8082 í¬íŠ¸"
  â†“ 4. ìš”ì²­ ì „ë‹¬: http://user-service:8082/user/123
  
[User Service:8082]
  â†“ 1. Redis ìºì‹œ í™•ì¸
  â”‚    - Key: "user:123"
  â”‚    - ìˆìœ¼ë©´ ë°”ë¡œ ë°˜í™˜ (ìºì‹œ íˆíŠ¸)
  â”‚    - ì—†ìœ¼ë©´ DB ì¡°íšŒ
  â†“ 2. PostgreSQL ì¡°íšŒ
  â”‚    - SELECT * FROM users WHERE id = 123
  â†“ 3. Redisì— ìºì‹±
  â”‚    - SET user:123 {data} EX 300 (5ë¶„)
  â†“ 4. ì‘ë‹µ ë°˜í™˜
  
[Gateway:8080]
  â†“ ì‘ë‹µ ì „ë‹¬
  
[Frontend]
  âœ“ ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: AI ê°ì • ë¶„ì„ (ì˜ˆì •)

```
[Frontend]
  â†“ POST http://localhost:8080/ai/analyze
  â†“ Body: {"text": "ì˜¤ëŠ˜ ê¸°ë¶„ì´ ì¢‹ì•„ìš”"}
  
[Gateway:8080]
  â†“ 1. ë¼ìš°íŒ…: /ai/** â†’ ai-middleware
  â†“ 2. Eureka ì¡°íšŒ (ë˜ëŠ” ì§ì ‘ ì£¼ì†Œ ì‚¬ìš©)
  â†“ 3. ìš”ì²­ ì „ë‹¬: http://ai-middleware:8090/analyze
  
[AI Middleware:8090]
  â†“ 1. Redis íì— ì‘ì—… ì¶”ê°€ (ë¹„ë™ê¸° ì²˜ë¦¬ìš©)
  â”‚    - LPUSH ai:queue {"text": "ì˜¤ëŠ˜ ê¸°ë¶„ì´ ì¢‹ì•„ìš”"}
  â†“ 2. Workerê°€ íì—ì„œ ì‘ì—… ê°€ì ¸ì˜´
  â”‚    - RPOP ai:queue
  â†“ 3. AI ëª¨ë¸ ì¶”ë¡ 
  â”‚    - ê°ì • ë¶„ì„ ëª¨ë¸ ì‹¤í–‰
  â”‚    - ê²°ê³¼: {"sentiment": "positive", "score": 0.95}
  â†“ 4. Redis ìºì‹±
  â”‚    - SET analysis:hash... {result} EX 3600
  â†“ 5. ì‘ë‹µ ë°˜í™˜
  
[Gateway:8080]
  â†“ ì‘ë‹µ ì „ë‹¬
  
[Frontend]
  âœ“ "ê¸ì •ì ì¸ ê°ì •ì…ë‹ˆë‹¤!" í‘œì‹œ
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì„œë¹„ìŠ¤ ê°„ í†µì‹  (Pub/Sub)

```
[Diary Service:8083]
  â†“ ì‚¬ìš©ìê°€ ìƒˆ ì¼ê¸° ì‘ì„±
  â†“ 1. PostgreSQLì— ì €ì¥
  â”‚    - INSERT INTO diaries ...
  â†“ 2. Redis Pub/Sub ì´ë²¤íŠ¸ ë°œí–‰
  â”‚    - PUBLISH diary.created {"diaryId": 456, "userId": 123}
  
[Redis:6379]
  â†“ ì´ë²¤íŠ¸ ë¸Œë¡œë“œìºìŠ¤íŠ¸
  
[Calendar Service:8084] (êµ¬ë…ì)
  â†“ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
  â†“ ìë™ìœ¼ë¡œ ì¼ì •ì— ì¼ê¸° ì‘ì„± ì´ë²¤íŠ¸ ì¶”ê°€
  
[User Service:8082] (êµ¬ë…ì)
  â†“ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
  â†“ ì‚¬ìš©ì í™œë™ í†µê³„ ì—…ë°ì´íŠ¸
  
[AI Middleware:8090] (êµ¬ë…ì)
  â†“ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
  â†“ ì¼ê¸° ë‚´ìš© ê°ì • ë¶„ì„ (ë¹„ë™ê¸°)
```

---

## í¬íŠ¸ ë§µ

### Infrastructure
| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìš©ë„ | ì™¸ë¶€ ì ‘ê·¼ |
|--------|------|------|-----------|
| Eureka | 8761 | Service Registry | âœ… (ëŒ€ì‹œë³´ë“œ) |
| Config Server | 8888 | ì¤‘ì•™ ì„¤ì • ê´€ë¦¬ | âŒ |

### Edge Layer
| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìš©ë„ | ì™¸ë¶€ ì ‘ê·¼ |
|--------|------|------|-----------|
| Gateway | 8080 | API Gateway | âœ… (ëª¨ë“  API) |

### Application Services
| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìš©ë„ | ì™¸ë¶€ ì ‘ê·¼ |
|--------|------|------|-----------|
| common-service | 8081 | ê³µí†µ ê¸°ëŠ¥ | âŒ (Gateway ê²½ìœ ) |
| user-service | 8082 | ì‚¬ìš©ì ê´€ë¦¬ | âŒ (Gateway ê²½ìœ ) |
| diary-service | 8083 | ì¼ê¸° ê´€ë¦¬ | âŒ (Gateway ê²½ìœ ) |
| calendar-service | 8084 | ì¼ì • ê´€ë¦¬ | âŒ (Gateway ê²½ìœ ) |
| soccer-service | 8085 | ì¶•êµ¬ ì •ë³´ | âŒ (Gateway ê²½ìœ ) |
| culture-service | 8086 | ë¬¸í™” ì •ë³´ | âŒ (Gateway ê²½ìœ ) |
| healthcare-service | 8087 | ê±´ê°• ê´€ë¦¬ | âŒ (Gateway ê²½ìœ ) |
| ai-middleware | 8090 | AI ì¶”ë¡  | âŒ (Gateway ê²½ìœ ) |

### Data Layer
| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìš©ë„ | ì™¸ë¶€ ì ‘ê·¼ |
|--------|------|------|-----------|
| PostgreSQL | 5432 | ë©”ì¸ DB | âŒ (ì„œë¹„ìŠ¤ë§Œ) |
| Redis | 6379 | ìºì‹œ/ì„¸ì…˜/í | âŒ (ì„œë¹„ìŠ¤ë§Œ) |

### Client
| ì„œë¹„ìŠ¤ | í¬íŠ¸ | ìš©ë„ | ì™¸ë¶€ ì ‘ê·¼ |
|--------|------|------|-----------|
| Frontend | 3000 | Next.js | âœ… (ì‚¬ìš©ì) |

---

## í•µì‹¬ ì •ë¦¬

### âœ… ë§ëŠ” ì´í•´
1. **GatewayëŠ” ë…ë¦½ì ì¸ ì„œë¹„ìŠ¤**
   - Eureka, Config Serverì™€ ê°™ì€ ê³„ì¸µì´ ì•„ë‹˜
   - Eurekaì˜ "í´ë¼ì´ì–¸íŠ¸" (ì„œë¹„ìŠ¤ ì¡°íšŒìš©)

2. **EurekaëŠ” "ì „í™”ë²ˆí˜¸ë¶€"**
   - ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ìì‹ ì„ ë“±ë¡
   - Gatewayê°€ ì„œë¹„ìŠ¤ ì£¼ì†Œë¥¼ ì¡°íšŒ

3. **ëª¨ë“  ìš”ì²­ì€ Gatewayë¥¼ í†µí•¨**
   - Frontend â†’ Gateway â†’ Microservice

4. **ì„œë¹„ìŠ¤ë“¤ì€ ì„œë¡œ ë…ë¦½ì **
   - ê°ì Eurekaì— ë“±ë¡
   - í•„ìš” ì‹œ Gateway ì—†ì´ ì§ì ‘ í†µì‹  ê°€ëŠ¥ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)

### âŒ ì˜ëª»ëœ ì´í•´
1. Gatewayê°€ Eureka/Config "ì•ˆì—" ìˆë‹¤ â†’ âŒ
2. Gatewayê°€ Eureka "ì‚¬ì´ì—" ìˆë‹¤ â†’ âŒ
3. Gatewayê°€ ì—†ìœ¼ë©´ ì„œë¹„ìŠ¤ ê°„ í†µì‹  ë¶ˆê°€ â†’ âŒ (í•˜ì§€ë§Œ Gateway ì‚¬ìš© ê¶Œì¥)

---

## ë‹¤ìŒ ë‹¨ê³„

### Phase 1: í˜„ì¬ êµ¬ì¡° ì•ˆì •í™”
- [ ] Redis ì—°ë™ í…ŒìŠ¤íŠ¸
- [ ] Gateway Rate Limiting êµ¬í˜„
- [ ] ê° ì„œë¹„ìŠ¤ ìºì‹± ì ìš©

### Phase 2: AI Middleware êµ¬ì¶•
- [ ] FastAPI ê¸°ë°˜ AI ì„œë¹„ìŠ¤ ìƒì„±
- [ ] Eureka ë“±ë¡ ë˜ëŠ” Gateway ì§ì ‘ ë¼ìš°íŒ…
- [ ] Redis í ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬

### Phase 3: Observability
- [ ] Prometheus + Grafana (ëª¨ë‹ˆí„°ë§)
- [ ] Zipkin (ë¶„ì‚° ì¶”ì )
- [ ] ELK Stack (ë¡œê·¸ ìˆ˜ì§‘)

### Phase 4: ê³ ê¸‰ ê¸°ëŠ¥
- [ ] Circuit Breaker (Resilience4j)
- [ ] Outbox íŒ¨í„´ (ì´ë²¤íŠ¸ ì†Œì‹±)
- [ ] CQRS íŒ¨í„´ ì ìš©

---

**ì‘ì„±ì¼**: 2024-11-21  
**ìµœì¢… ìˆ˜ì •ì¼**: 2024-11-21  
**ë²„ì „**: 2.0  
**í”„ë¡œì íŠ¸**: AIION Microservices Architecture

### ë³€ê²½ ì´ë ¥
- **v2.0** (2024-11-21)
  - Gatewayì™€ Eureka í†µì‹  ë©”ì»¤ë‹ˆì¦˜ ì¶”ê°€ (ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ì„¤ëª…)
  - ë™ì‹œì„± ë° ì¶©ëŒ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ ì¶”ê°€
  - ì„±ëŠ¥ ìµœì í™” ì „ëµ ì¶”ê°€
- **v1.0** (2024-11-21)
  - ì´ˆê¸° ë²„ì „ ì‘ì„±

